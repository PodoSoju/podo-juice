# Compact at 2026-01-11 12:10

## 대화 요약

### 완료된 작업

#### 1. URL Scheme 기반 앱 번들 생성
- `podosoju://run/{workspace-id}/{encoded-exe-path}` URL scheme 구현
- AppBundleGenerator.swift 생성 - .app 번들 자동 생성
- AppleScript launcher로 검은 터미널 창 없이 실행
- 바로가기 우클릭 → "Create App Bundle" 메뉴 추가
- Wine 이미 실행 중이면 포커스만 (lsof로 확인)

#### 2. PodoSoju 창 중복 방지
- `handlesExternalEvents(matching: [])` 로 URL 호출 시 새 창 안 열림
- Wine Logs 창 자동 열림 방지

#### 3. Winetricks 개선
- WINE, WINESERVER, PATH 환경변수 설정
- `--force` 옵션 추가 (체크섬 검증 스킵)
- 인라인 진행상황 표시 UI 추가 (Install 버튼 옆)
- WinetricksInstallManager 싱글톤으로 상태 유지 (View 닫아도)
- 다중 동시 설치 지원

#### 4. Winetricks 다운로드 진행률 (진행 중)
- wget이 tty 아니면 진행률 안 출력하는 문제
- `\r` 처리하는 라인 리더 구현
- TERM=xterm 설정 시도
- openpty()로 진짜 pty 생성 시도 중

### 현재 상태
- 브랜치: main
- 진행 상황: winetricks 다운로드 % 캡처 작업 중

### 최근 커밋
- fix: Set TERM=xterm to enable wget progress output (a3bce3a)
- fix: Remove pty wrapper, run winetricks directly (bfb9da7)
- fix: Run script command via bash for proper pty creation (722392d)
- feat: Persist winetricks install state across view lifecycle (bbfcbf1)
- fix: Capture wget progress by handling carriage return in output (753d5de)

### 다음 할 일
- openpty() 기반 pty 구현 완성 → 빌드/테스트
- 다운로드 진행률 UI 확인
- NetFile 앱 크래시 문제는 Wine 호환성 이슈 (별도)

### 중요 결정사항
- 앱 번들은 PodoSoju를 통해 Wine 실행 (URL scheme)
- launcher는 AppleScript로 검은 창 방지
- winetricks 상태는 WinetricksInstallManager 싱글톤으로 관리

### 주요 파일
- PodoSoju/Services/AppBundleGenerator.swift
- PodoSoju/Services/WinetricksInstallManager.swift
- PodoSojuKit/Managers/SojuManager.swift (runWinetricks, runWithPty)
- PodoSoju/Views/Workspace/WorkspaceSettingsView.swift (WinetricksTab)
